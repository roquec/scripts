name: Windows setup tests

on: [workflow_dispatch]

jobs:
  setup:
    runs-on: windows-latest

    steps:
    - name: Install winget
      uses: Cyberboss/install-winget@v1
      
    - name: Execute script
      shell: PowerShell
      run: iwr -useb https://raw.githubusercontent.com/roquec/scripts/main/windows/bootstrap.ps1 | iex

    - uses: actions/checkout@v4

    - name: Add to PATH
      shell: pwsh
      run: echo "C:\Users\runneradmin\AppData\Local\Programs\oh-my-posh\bin" | Out-File -FilePath $env:GITHUB_PATH -Encoding utf8 -Append

    - name: Verify Installation
      shell: pwsh
      run: .\.github\actions\verify-installation.ps1
      
    - name: Verify Terminal Config
      shell: pwsh
      run: .\.github\actions\verify-terminal-config.ps1

